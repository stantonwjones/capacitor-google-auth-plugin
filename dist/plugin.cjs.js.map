{"version":3,"file":"plugin.cjs.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst CapacitorGoogleAuth = registerPlugin('CapacitorGoogleAuth', {\n    web: () => import('./web').then((m) => new m.CapacitorGoogleAuthWeb()),\n});\nexport * from './definitions';\nexport { CapacitorGoogleAuth };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nexport class CapacitorGoogleAuthWeb extends WebPlugin {\n    constructor() {\n        super();\n        this.googleApiLoadedSuccessfully = () => { };\n        this.googleApiFailedToLoad = () => { };\n        this.googleApiLoaded = new Promise((resolve, reject) => {\n            this.googleApiLoadedSuccessfully = () => {\n                resolve();\n            };\n            this.googleApiFailedToLoad = () => reject();\n        });\n        console.log(\"constructor called\");\n        this.loadScript();\n    }\n    async authorize(options) {\n        await this.googleApiLoaded;\n        return new Promise(async (resolve, reject) => {\n            try {\n                google.accounts.id.initialize({\n                    client_id: options.clientId,\n                    callback: (googleUser) => {\n                        console.log(googleUser);\n                        resolve({ accessToken: googleUser.credential });\n                    },\n                });\n                google.accounts.id.prompt();\n            }\n            catch (error) {\n                reject(error);\n            }\n        });\n    }\n    // async refresh() {\n    //   const authResponse = await gapi.auth2.getAuthInstance().currentUser.get().reloadAuthResponse();\n    //   return {\n    //     accessToken: authResponse.access_token,\n    //     idToken: authResponse.id_token,\n    //     refreshToken: '',\n    //   };\n    // }\n    // async signOut() {\n    //   return gapi.auth2.getAuthInstance().signOut();\n    // }\n    // async addUserChangeListener() {\n    //   await this.gapiLoaded;\n    //   gapi.auth2.getAuthInstance().currentUser.listen((googleUser) => {\n    //     this.notifyListeners('userChange', googleUser.isSignedIn() ? this.getUserFrom(googleUser) : null);\n    //   });\n    // }\n    getUserFrom(googleUser) {\n        const user = {};\n        const profile = googleUser.getBasicProfile();\n        user.email = profile.getEmail();\n        user.familyName = profile.getFamilyName();\n        user.givenName = profile.getGivenName();\n        user.id = profile.getId();\n        user.imageUrl = profile.getImageUrl();\n        user.name = profile.getName();\n        const authResponse = googleUser.getAuthResponse(true);\n        user.accessToken = authResponse.access_token;\n        user.idToken = authResponse.id_token;\n        user.refreshToken = '';\n        return user;\n    }\n    // Dynamically loads google api scripts\n    loadScript() {\n        if (typeof document === 'undefined') {\n            return;\n        }\n        const scriptId = 'gapi';\n        const scriptEl = document === null || document === void 0 ? void 0 : document.getElementById(scriptId);\n        if (scriptEl) {\n            return;\n        }\n        const head = document.getElementsByTagName('head')[0];\n        const script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.defer = true;\n        script.async = true;\n        script.id = scriptId;\n        script.onload = () => this.googleApiLoadedSuccessfully();\n        script.src = 'https://accounts.google.com/gsi/client';\n        head.appendChild(script);\n    }\n}\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin"],"mappings":"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"}